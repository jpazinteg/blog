<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>SharePoint から Azure Blob Storage に大容量ファイルをコピーする | Japan Azure Integration Support Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="こんにちは！ Azure Integration サポート チームの 武田 です。頻繁にいただくお問い合わせに、SharePoint Online からファイルを取得して Azure Blob Storage にアップロードしたいけれど、ファイルサイズが大きいためにコネクタを使用できない、というものがございます。そこで今回は、SharePoint Online から Azure Blob Stor">
<meta property="og:type" content="article">
<meta property="og:title" content="SharePoint から Azure Blob Storage に大容量ファイルをコピーする">
<meta property="og:url" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/index.html">
<meta property="og:site_name" content="Japan Azure Integration Support Blog">
<meta property="og:description" content="こんにちは！ Azure Integration サポート チームの 武田 です。頻繁にいただくお問い合わせに、SharePoint Online からファイルを取得して Azure Blob Storage にアップロードしたいけれど、ファイルサイズが大きいためにコネクタを使用できない、というものがございます。そこで今回は、SharePoint Online から Azure Blob Stor">
<meta property="og:locale" content="ja_JP">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image001.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image017.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image002.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image018.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image019.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image020.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image003.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image004.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image005.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image006.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image007.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image008.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image009.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image010.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image011.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image012.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image013.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image014.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image015.png">
<meta property="og:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image016.png">
<meta property="article:published_time" content="2025-11-10T15:00:00.000Z">
<meta property="article:modified_time" content="2025-12-18T02:19:24.942Z">
<meta property="article:author" content="Japan Azure Integration Support Team">
<meta property="article:tag" content="How-To">
<meta property="article:tag" content="Tips">
<meta property="article:tag" content="Azure Integration">
<meta property="article:tag" content="Azure Logic Apps">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image001.png">
  
    <link rel="alternate" href="../../atom.xml" title="Japan Azure Integration Support Blog" type="application/atom+xml">
  

  <link rel="icon" href="../../favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
  <link rel="manifest" href="../../site.webmanifest">
  <link rel="mask-icon" href="../../safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="theme-color" content="#ffffff">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="../../css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="site-header-logo"></div>
  <div id="site-header-blog-wrapper"></div>
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        <div id="ms-logo"></div>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
        <a class="main-nav-link" target="_blank" rel="noopener" href="https://cssjpn.github.io/">サポート情報</a>
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="../../atom.xml" title="RSSフィード"></a>
        
      </nav>
      <div id="search-form-wrap">
        <form action="//www.bing.com/search" method="get" accept-charset="UTF-8" name="bing-search" onsubmit="var f=this;if(f['q'].value){var searchUrl =  'https://www.bing.com/search?q=' +  encodeURIComponent(f['q'].value + ' site:' + f['sitesearch'].value) ;window.open(searchUrl, 'blank') };return false;" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="検索"><button type="submit" id="nav-search-btn" class="search-form-submit"></button><input type="hidden" name="sitesearch" value="https://jpazinteg.github.io/blog"></form>
      </div>
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="../../index.html" id="logo">Japan Azure Integration Support Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="../../index.html" id="subtitle">日本マイクロソフトの Azure Integration に関するサポート情報のブログです。</a>
        </h2>
      
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-LogicApps/copyLargeFileFromSPO2BlobStorage" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header-single">
        
  
    <h1 class="article-title" itemprop="name">
      SharePoint から Azure Blob Storage に大容量ファイルをコピーする
    </h1>
  

      </header>
      <div class="article-share">
        Last Update: 
        <a href="" class="article-date-single">
  <time datetime="2025-11-10T15:00:00.000Z" itemprop="datePublished">2025-11-11</time>
</a>
        
        
        <a href="https://github.com/jpazinteg/blog/issues/new?title=&body=%0A%0A---%0A%0A%23%23%23%23+Document+Details%0A%0A%E2%9A%A0+*Do+not+edit+this+section.%0A%0A*+ID%3A+f371d85c-dd1c-54cd-9f90-c02305c7dc9b%0A*+%E5%AF%BE%E8%B1%A1%E8%A8%98%E4%BA%8B%3A+%5BSharePoint+%E3%81%8B%E3%82%89+Azure+Blob+Storage+%E3%81%AB%E5%A4%A7%E5%AE%B9%E9%87%8F%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B%5D%28https%3A%2F%2Fjpazinteg.github.io%2Fblog%2FLogicApps%2FcopyLargeFileFromSPO2BlobStorage%2F%29%0A*+Content+Source%3A+%5Barticles%2FLogicApps%2FcopyLargeFileFromSPO2BlobStorage.md%5D%28https%3A%2F%2Fgithub.com%2Fjpazinteg%2Fblog%2Fblob%2Fmain%2Farticles%2FLogicApps%2FcopyLargeFileFromSPO2BlobStorage.md%29%0A*+Author%3A+" class="article-github-issue-link" target="_blank" rel="noopener noreferrer">feedback</a>
        
        <a data-url="https://jpazinteg.github.io/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/" data-id="cmjatb90e002l0nnxclyh2z4u" class="article-share-link">共有</a>
      </div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>こんにちは！ Azure Integration サポート チームの 武田 です。<br>頻繁にいただくお問い合わせに、SharePoint Online からファイルを取得して Azure Blob Storage にアップロードしたいけれど、ファイルサイズが大きいためにコネクタを使用できない、というものがございます。<br>そこで今回は、SharePoint Online から Azure Blob Storage へ、大容量ファイルをコピーする方法を紹介させていただきます。</p>
<span id="more"></span>

<h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul>
<li>処理の流れ</li>
<li>Graph API を使用するための前準備</li>
<li>取得するファイルの itemID を取得する</li>
<li>Graph API を使用してダウンロード URL を取得する</li>
<li>URL を使用して、Azure Blob Storage に BLOB を作成する</li>
<li>実行結果の確認</li>
<li>留意点</li>
<li>まとめ</li>
</ul>
<br/>

<h2 id="処理の流れ"><a href="#処理の流れ" class="headerlink" title="処理の流れ"></a>処理の流れ</h2><p>具体的な設定方法をご案内する前に、簡単に処理の流れをご案内します。<br>本手順の処理は、大きく以下の 3 つに分けることができます。</p>
<ol>
<li>SharePoint Online から取得するファイルの、itemId を取得する</li>
<li>Graph API を使用して、1 のファイルをダウンロードする URL を発行する</li>
<li>2 で発行した URL を使用して、Azure Blob Storage に BLOB を作成する</li>
</ol>
<p>詳細な設定手順は各項目でご説明致しますが、まずは上記のような流れで処理を行いますこと、お心に留めていただけますと幸いです。</p>
<br/>

<h2 id="Graph-API-を使用するための前準備"><a href="#Graph-API-を使用するための前準備" class="headerlink" title="Graph API を使用するための前準備"></a>Graph API を使用するための前準備</h2><p>本手順には、Graph API を使用する手順が含まれます。<br>Graph API の認証に必要なアプリケーションにアクセス許可を付与する必要がございますため、事前にその設定をしておく必要がございます。<br>この設定方法については、当ブログの別記事にて詳細な手順をご案内しております。<br>後述する手順を実行される前に、以下ブログを参照の上、あらかじめ Graph API 実行のためのアクセス許可をご設定ください。</p>
<ul>
<li><a href="https://jpazinteg.github.io/blog/LogicApps/Integration-graphApi/">Logic Apps から Graph API を実行する | Japan Azure Integration Support Blog</a></li>
</ul>
<p>付与いただくアクセス権は以下の通りです。<br>今回使用する Graph API、「driveItem コンテンツのダウンロード」で必要とされるアクセス許可は、以下のいずれかとなります。<br>お客様のご要件に合わせて、付与するアクセス許可を選定ください。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image001.png"></p>
<br/>

<h2 id="取得するファイルの-itemID-を取得する"><a href="#取得するファイルの-itemID-を取得する" class="headerlink" title="取得するファイルの itemID を取得する"></a>取得するファイルの itemID を取得する</h2><p>本記事では、SharePoint Online から任意のファイルをダウンロードするのに、「driveItem コンテンツのダウンロード」という Graph API を使用します。<br>この Graph API を使用するには、ダウンロードするファイルの siteId、driveId および itemId がわかっている必要があります。<br>このうち siteId と driveId は通常固定となりますため、あらかじめ確認して固定値ないしはパラメーター等に設定することが可能ですが、ファイルごとに変わる itemId は都度取得する必要がございます。</p>
<p>本記事では、Shared Document 直下に配置されているファイルを取得するものとして、手順をご紹介します。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image017.png"></p>
<p>余談ですが、こちらのファイルのサイズは 500 MB としております。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image002.png"></p>
<p><b>siteId と driveId の取得方法</b><br>siteId と driveId は、Graph Explorer よりあらかじめ確認することが可能です。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.microsoft.com/en-us/graph/graph-explorer">Graph Explorer | Try Microsoft Graph APIs - Microsoft Graph</a></li>
</ul>
<p>では実際に、Graph Explorer から siteId と driveId を確認してみます。</p>
<p>まずはGraph Explorer にアクセスし、ログインします。<br>ログインしているユーザーが対象となるドライブやファイル、フォルダの閲覧権限以上を持っている必要がありますのでご注意ください。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image018.png"></p>
<p>まずは siteId を取得します。<br>Graph Explorer に以下の URL をセットして、Run query を押下します。<br>検索する値は、SharePoint のサイト名やファイル名など、任意ものものを使用してください。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET https://graph.microsoft.com/v1.0/sites?search=&lt;検索する値&gt;</span><br></pre></td></tr></table></figure>

<p>以下は検索結果の例です。<br>value 内に記載されている id が siteId です。siteId は後続処理でも使用しますので、値を控えておきます。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image019.png"></p>
<p>siteId が取得できたので、続いては左記を使用して driveId を取得します。<br>Graph Explorer に以下の URL をセットして、Run query を押下します。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET https://graph.microsoft.com/v1.0/sites/&lt;siteId&gt;/drive</span><br></pre></td></tr></table></figure>

<p>以下は検索結果の例です。<br>黄色の枠で囲っている id が driveId です。driveId は後続処理でも使用しますので、値を控えておきます。<br>なお、webUrl に記載されている URL が、参照先の SharePoint になっていることをご確認ください。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image020.png"></p>
<p>以上で、siteId と driveId の取得は終了です。</p>
<p><b>itemId の取得方法</b><br>siteId と driveId が取得できたので、これらを使って SharePoint Online から取得対象のファイルの itemId を取得します。<br>itemId の取得につきましては、次の URI を [HTTP] アクションに設定いただくことで取得可能です。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://graph.microsoft.com/v1.0/sites/&#123;siteId&#125;/drives/&#123;driveId&#125;/root:/&#123;fileName&#125;</span><br></pre></td></tr></table></figure>

<p>上記形式に落とし込んだ URL が正しく実行できるかは、Graph Exolorer よりご確認いただくことが可能です。<br>[HTTP] アクションにご設定をいただきます前に、まずは Graph Explorer を使用して記述内容に問題がないかを確認することを、強くお勧めいたします。</p>
<p>上記を踏まえた、itemid を取得するための [HTTP] アクションの設定例がこちらです。<br>詳細パラメーターより設定する Authentication については、「Graph API を使用するための前準備」でご案内している内容に準拠しますため割愛します。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image003.png"></p>
<p>当アクションの実行結果は以下です。<br>body 直下にある「id」の値が、今回使用する itemId の値でございます。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image004.png"></p>
<br/>

<h2 id="Graph-API-を使用してダウンロード-URL-を取得する"><a href="#Graph-API-を使用してダウンロード-URL-を取得する" class="headerlink" title="Graph API を使用してダウンロード URL を取得する"></a>Graph API を使用してダウンロード URL を取得する</h2><p>取得対象のファイルの itemId が取得できましたので、Graph API「driveItem コンテンツのダウンロード」を使用して、対象のファイルのダウンロード URL を取得します。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/graph/api/driveitem-get-content?view=graph-rest-1.0&tabs=http">driveItem コンテンツのダウンロード - Microsoft Graph v1.0 | Microsoft Learn</a></li>
</ul>
<p>当該 Graph API を呼び出すための URL のパターンはいくつかございますが、今回は下図黄色下線を引いている形式を使用します。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image005.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://graph.microsoft.com/v1.0/sites/&#123;siteId&#125;/drive/items/&#123;itemId&#125;/content</span><br></pre></td></tr></table></figure>

<p>上記を踏まえた、当該 Graph API を呼び出す [HTTP] アクションの設定がこちらです。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image006.png"></p>
<p>「items」と「content」の間に設定する itemId は可変値となりますため、前段で itemId を取得している [HTTP] アクションの body 部より取得する形をとっています。<br>コードで見た場合は以下の通りです。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image007.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">body(&#x27;&#123;itemId を取得した HTTP アクションのアクション名&#125;&#x27;)?[&#x27;id&#x27;]</span><br></pre></td></tr></table></figure>

<p>当アクションの実行結果は以下です。<br>処理が正常に実行できた場合、応答として Status code: 302、Found を受け取ります。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image008.png"></p>
<p>しかし、Logic Apps では 302 応答を正常終了として取り扱えないため、後続処理に [Condition] アクションを設定することで処理を継続させます。</p>
<p>[Condition] アクションの設定内容は以下の通りです。<br>分岐条件として、ダウンロード URL を取得する [HTTP] アクションの Status code が 302 かどうかを設定します。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image009.png"></p>
<p>また、Status code: 302 を応答として受け取っても [Condition] アクションを実行できるよう、[設定] タブより、前段のアクションが失敗した場合も実行条件として設定します。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image010.png"></p>
<br/>

<h2 id="URL-を使用して、Azure-Blob-Storage-に-BLOB-を作成する"><a href="#URL-を使用して、Azure-Blob-Storage-に-BLOB-を作成する" class="headerlink" title="URL を使用して、Azure Blob Storage に BLOB を作成する"></a>URL を使用して、Azure Blob Storage に BLOB を作成する</h2><p>続いて、取得したダウンロード URL を用いて Azure Blob Storage に BLOB を作成します。<br>本手順には、REST API の「URL から BLOB を配置」を使用します。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/rest/api/storageservices/put-blob-from-url?tabs=microsoft-entra-id">URL からの BLOB の配置 (REST API) - Azure Storage | Microsoft Learn</a></li>
</ul>
<p>[HTTP] アクションの URI 欄に設定する URI は、以下の形式となります。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://&#123;ストレージ アカウント名&#125;.blob.core.windows.net/&#123;コンテナー名&#125;/&#123;保存するファイル名&#125;</span><br></pre></td></tr></table></figure>

<p>今回の例では、以下のコンテナーに「testFile.txt」というファイル名で BLOB を作成するものとします。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image011.png"></p>
<p>上記を踏まえた、当該 REST API を呼び出す [HTTP] アクションの設定内容がこちらです。<br>今回は、認証に SAS 認証を使用しておりますため、URI の一部をマスキングしております。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image012.png"></p>
<p>認証方法を含め、設定内容を順番にご説明させていただきます。</p>
<p><b>認証方法</b><br>SAS 認証のほか、使用可能な認証方式のご用意がございます。<br>どの認証方式を採用されるかにつきましては、お客様のご要件に合わせてご検討ください。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/rest/api/storageservices/authorize-requests-to-azure-storage">Azure Storage への要求を承認する (REST API) | Microsoft Learn</a></li>
</ul>
<p><b>x-ms-date</b><br>必須項目で、世界協定時刻(UTC)を設定します。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utcNow(&#x27;u&#x27;)</span><br></pre></td></tr></table></figure>

<p><b>x-ms-copy-source</b><br>必須項目で、「Graph API を使用してダウンロード URL を取得する」にて取得したダウンロード URL を設定します。<br>ダウンロード URL は、以下の形で取得いただくことが可能です。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outputs(&#x27;&#123;ダウンロード URL を取得した HTTP アクションのアクション名&#125;&#x27;)?[&#x27;headers&#x27;]?[&#x27;Location&#x27;]</span><br></pre></td></tr></table></figure>

<p><b>x-ms-blob-type</b><br>固定値で「BlockBlob」と設定します。<br>なお、本設定が漏れますと、ファイルサイズ 0 の BLOB が作成されてしまいますので、ご注意ください。</p>
<p><b>Content-Length</b><br>固定値で「0」を設定します。</p>
<p><b>x-ms-version</b><br>2020-04-08 以降の、任意の API バージョンをご設定ください。</p>
<p>以上で、SharePoint Online から Azure Blob Storage へファイルをコピーする処理の設定が完了しました。</p>
<br/>

<h2 id="実行結果の確認"><a href="#実行結果の確認" class="headerlink" title="実行結果の確認"></a>実行結果の確認</h2><p>では、設定したワークフローを実際に動かしてみます。</p>
<p>まずは処理が正常終了したことを確認します。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image013.png"></p>
<p>指定した Blob Storage のコンテナーを確認します。<br>BLOB が作成されていることが確認できます。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image014.png"></p>
<br/>

<h2 id="留意点"><a href="#留意点" class="headerlink" title="留意点"></a>留意点</h2><p>「URL からの BLOB の配置」は、バージョン 2020-04-08 以降でサポートされております。<br>設定いただく API のバージョンにご注意ください。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image015.png"></p>
<p>「URL からの BLOB の配置」で取り扱えるのは 5000 MiB まででございます。<br>上記サイズを超えるファイルにつきましては、本記事でご紹介しております手順をもってしても、SharePoint Online から Azure Blob Storage へのコピーが叶いません。<br><img src="/blog/LogicApps/copyLargeFileFromSPO2BlobStorage/image016.png"></p>
<br/>

<h2 id="まとめ"><a href="#まとめ" class="headerlink" title="まとめ"></a>まとめ</h2><p>本記事では、以下についてご案内いたしましたが、ご理解いただけましたでしょうか。</p>
<ul>
<li>SharePoint Online に格納されているファイルの itemId を取得する方法</li>
<li>Graph API を用いて、SharePoint Online に保存されているファイルのダウンロード URL を取得する方法</li>
<li>URL を使用して Azure Blob Storage に BLOB を作成する方法</li>
</ul>
<p>一連の処理としてご案内をしておりますが、それぞれ単独でもご使用いただける内容かと存じます。<br>本記事でご案内しております内容以外にも、是非ご活用ください。</p>
<p>本記事が少しでもお役に立ちましたら幸いです。最後までお読みいただき、ありがとうございました！</p>
<p>&lt;Azure Logic Apps の参考サイト&gt;<br>– 概要 - Azure Logic Apps とは<br><a target="_blank" rel="noopener" href="https://learn.microsoft.com/ja-jp/azure/logic-apps/logic-apps-overview">https://learn.microsoft.com/ja-jp/azure/logic-apps/logic-apps-overview</a><br>Azure Logic Apps とは、ロジック アプリ デザイナーでフロー チャートを用いて作成したワークフローを自動実行するソリューションです。<br>Azure Logic Apps では、条件分岐などを実装することができ、ワークフローの実行状況に応じて実行する処理を分岐することが可能です。</p>

      
      
        <div class="article-disclaimer">
        
          <p>※本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。</p>
        
        </div>
      
    </div>
    <footer class="article-footer">
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/Azure-Integration/" rel="tag">Azure Integration</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/Azure-Logic-Apps/" rel="tag">Azure Logic Apps</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/How-To/" rel="tag">How-To</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="../../tags/Tips/" rel="tag">Tips</a></li></ul>

        
        <a href="https://github.com/jpazinteg/blog/edit/main/articles/LogicApps/copyLargeFileFromSPO2BlobStorage.md" class="article-github-edit-link" target="_blank" rel="noopener noreferrer">GitHub で編集</a>
        
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="../../MSMQ/KB5071544_202512/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">次の記事</strong>
      <div class="article-nav-title">
        
          2025 年 12 月の Windows セキュリティ更新プログラム KB5071544 等に関連する MSMQ のご案内
        
      </div>
    </a>
  
  
    <a href="../CleanandTransformtheRetrievedCSVfile/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前の記事</strong>
      <div class="article-nav-title">取得した CSV ファイルのデータを加工する</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最近の投稿</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="../../MSMQ/KB5071544_202512/">2025 年 12 月の Windows セキュリティ更新プログラム KB5071544 等に関連する MSMQ のご案内</a>
          </li>
        
          <li>
            <a href="">SharePoint から Azure Blob Storage に大容量ファイルをコピーする</a>
          </li>
        
          <li>
            <a href="../CleanandTransformtheRetrievedCSVfile/">取得した CSV ファイルのデータを加工する</a>
          </li>
        
          <li>
            <a href="../LogicApps-Recovery/">Standard Logic Apps のワークフローを誤って削除してしまったとき</a>
          </li>
        
          <li>
            <a href="../LogicApps-UpdateWithCLI/">CLI から従量課金タイプの Logic Apps の設定を更新する</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">タグ</h3>
    <div class="widget">
      <!-- <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="../../tags/API-%E6%8E%A5%E7%B6%9A/" rel="tag">API 接続</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Azure-Automation/" rel="tag">Azure Automation</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Azure-CLI/" rel="tag">Azure CLI</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Azure-Cosmos-DB/" rel="tag">Azure Cosmos DB</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Azure-DevOps/" rel="tag">Azure DevOps</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Azure-Integration/" rel="tag">Azure Integration</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Azure-Logic-Apps/" rel="tag">Azure Logic Apps</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Azure-Monitor/" rel="tag">Azure Monitor</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Azure-Monitor-Logs/" rel="tag">Azure Monitor Logs</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Azure-OpenAI/" rel="tag">Azure OpenAI</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/BizTalk/" rel="tag">BizTalk</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Excel-Onlne/" rel="tag">Excel Onlne</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/For-each/" rel="tag">For each</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/General/" rel="tag">General</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Google-Sheets/" rel="tag">Google Sheets</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Graph-API/" rel="tag">Graph API</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/HIS/" rel="tag">HIS</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/HTTP-%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/" rel="tag">HTTP アクション</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/How-To/" rel="tag">How-To</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Ip-address/" rel="tag">Ip address</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Issues/" rel="tag">Issues</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/JDBC/" rel="tag">JDBC</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Log/" rel="tag">Log</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/MSMQ/" rel="tag">MSMQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Retry-Policy/" rel="tag">Retry Policy</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Standard/" rel="tag">Standard</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Standard-Logic-Apps/" rel="tag">Standard Logic Apps</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Storage-Account/" rel="tag">Storage Account</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Tips/" rel="tag">Tips</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Trigger/" rel="tag">Trigger</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Trouble/" rel="tag">Trouble</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Unix-Time/" rel="tag">Unix Time</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/VNet-Integration/" rel="tag">VNet Integration</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%83%97%E3%83%AD%E3%83%90%E3%82%A4%E3%83%80%E3%83%BC%E6%8E%A5%E7%B6%9A/" rel="tag">サービス プロバイダー接続</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E3%83%81%E3%83%BC%E3%83%A0%E7%B4%B9%E4%BB%8B/" rel="tag">チーム紹介</a></li><li class="tag-list-item"><a class="tag-list-link" href="../../tags/%E8%AA%8D%E8%A8%BC/" rel="tag">認証</a></li></ul>  -->
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="../../tags/Azure-Logic-Apps/">Azure Logic Apps</a><span class="tag-list-count">55</span><ul><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/API-%E6%8E%A5%E7%B6%9A">API 接続</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Azure-Automation">Azure Automation</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Azure-CLI">Azure CLI</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Azure-Cosmos-DB">Azure Cosmos DB</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Azure-DevOps">Azure DevOps</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Azure-Integration">Azure Integration</a><span class="tag-list-count">55</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Azure-Monitor">Azure Monitor</a><span class="tag-list-count">2</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Azure-Monitor-Logs">Azure Monitor Logs</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Azure-OpenAI">Azure OpenAI</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Excel-Onlne">Excel Onlne</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/For-each">For each</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Google-Sheets">Google Sheets</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Graph-API">Graph API</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/HTTP-%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3">HTTP アクション</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/How-To">How-To</a><span class="tag-list-count">48</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Ip-address">Ip address</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Issues">Issues</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/JDBC">JDBC</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Log">Log</a><span class="tag-list-count">1</span></li><li class="tag-list-item tag-list-item-child-tag"><a class="tag-list-link tag-list-link-child" href="../../tags/Azure-Logic-Apps/Retry-Policy">Retry Policy</a><span class="tag-list-count">1</span></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">アーカイブ</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/12/">2025 / 12</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/11/">2025 / 11</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/09/">2025 / 09</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/06/">2025 / 06</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/05/">2025 / 05</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/02/">2025 / 02</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2025/01/">2025 / 01</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2024/11/">2024 / 11</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2024/07/">2024 / 07</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2024/04/">2024 / 04</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/12/">2023 / 12</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/11/">2023 / 11</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/10/">2023 / 10</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/09/">2023 / 09</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/08/">2023 / 08</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/07/">2023 / 07</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/06/">2023 / 06</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/05/">2023 / 05</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/04/">2023 / 04</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/03/">2023 / 03</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/02/">2023 / 02</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2023/01/">2023 / 01</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/12/">2022 / 12</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/11/">2022 / 11</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/10/">2022 / 10</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/09/">2022 / 09</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/08/">2022 / 08</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/07/">2022 / 07</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/06/">2022 / 06</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/05/">2022 / 05</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/04/">2022 / 04</a></li><li class="archive-list-item"><a class="archive-list-link" href="../../archives/2022/03/">2022 / 03</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">タグクラウド</h3>
    <div class="widget tagcloud">
      <a href="../../tags/API-%E6%8E%A5%E7%B6%9A/" style="font-size: 10px;">API 接続</a> <a href="../../tags/Azure-Automation/" style="font-size: 10px;">Azure Automation</a> <a href="../../tags/Azure-CLI/" style="font-size: 10px;">Azure CLI</a> <a href="../../tags/Azure-Cosmos-DB/" style="font-size: 10px;">Azure Cosmos DB</a> <a href="../../tags/Azure-DevOps/" style="font-size: 10px;">Azure DevOps</a> <a href="../../tags/Azure-Integration/" style="font-size: 20px;">Azure Integration</a> <a href="../../tags/Azure-Logic-Apps/" style="font-size: 18.57px;">Azure Logic Apps</a> <a href="../../tags/Azure-Monitor/" style="font-size: 11.43px;">Azure Monitor</a> <a href="../../tags/Azure-Monitor-Logs/" style="font-size: 10px;">Azure Monitor Logs</a> <a href="../../tags/Azure-OpenAI/" style="font-size: 10px;">Azure OpenAI</a> <a href="../../tags/BizTalk/" style="font-size: 10px;">BizTalk</a> <a href="../../tags/Excel-Onlne/" style="font-size: 10px;">Excel Onlne</a> <a href="../../tags/For-each/" style="font-size: 10px;">For each</a> <a href="../../tags/General/" style="font-size: 11.43px;">General</a> <a href="../../tags/Google-Sheets/" style="font-size: 10px;">Google Sheets</a> <a href="../../tags/Graph-API/" style="font-size: 10px;">Graph API</a> <a href="../../tags/HIS/" style="font-size: 10px;">HIS</a> <a href="../../tags/HTTP-%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3/" style="font-size: 10px;">HTTP アクション</a> <a href="../../tags/How-To/" style="font-size: 18.57px;">How-To</a> <a href="../../tags/Ip-address/" style="font-size: 10px;">Ip address</a> <a href="../../tags/Issues/" style="font-size: 10px;">Issues</a> <a href="../../tags/JDBC/" style="font-size: 10px;">JDBC</a> <a href="../../tags/Log/" style="font-size: 11.43px;">Log</a> <a href="../../tags/MSMQ/" style="font-size: 15.71px;">MSMQ</a> <a href="../../tags/Retry-Policy/" style="font-size: 10px;">Retry Policy</a> <a href="../../tags/Standard/" style="font-size: 10px;">Standard</a> <a href="../../tags/Standard-Logic-Apps/" style="font-size: 12.86px;">Standard Logic Apps</a> <a href="../../tags/Storage-Account/" style="font-size: 11.43px;">Storage Account</a> <a href="../../tags/Tips/" style="font-size: 17.14px;">Tips</a> <a href="../../tags/Trigger/" style="font-size: 14.29px;">Trigger</a> <a href="../../tags/Trouble/" style="font-size: 11.43px;">Trouble</a> <a href="../../tags/Unix-Time/" style="font-size: 10px;">Unix Time</a> <a href="../../tags/VNet-Integration/" style="font-size: 10px;">VNet Integration</a> <a href="../../tags/%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%83%97%E3%83%AD%E3%83%90%E3%82%A4%E3%83%80%E3%83%BC%E6%8E%A5%E7%B6%9A/" style="font-size: 10px;">サービス プロバイダー接続</a> <a href="../../tags/%E3%83%81%E3%83%BC%E3%83%A0%E7%B4%B9%E4%BB%8B/" style="font-size: 10px;">チーム紹介</a> <a href="../../tags/%E8%AA%8D%E8%A8%BC/" style="font-size: 10px;">認証</a>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2025 Japan Azure Integration Support Team<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="../../index.html" class="mobile-nav-link">Home</a>
  
    <a href="../../archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<script src="../../js/script.js"></script>




  </div>
</body>
</html>